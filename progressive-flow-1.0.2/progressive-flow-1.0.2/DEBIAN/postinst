#!/bin/bash

#!/bin/bash

set -e

# Path di installazione del binario
BIN_SOURCE="/opt/progressive-flow/bin/proflow"
BIN_TARGET="/usr/bin/proflow"

# Creazione del link simbolico se il binario esiste
if [ -f "$BIN_SOURCE" ]; then
    ln -sf "$BIN_SOURCE" "$BIN_TARGET"
    echo "Link simbolico creato: $BIN_TARGET -> $BIN_SOURCE"
else
    echo "Errore: il binario $BIN_SOURCE non esiste. Controlla l'installazione."
    exit 1
fi

exit 0

# Controlla se il file /etc/gitconfig esiste
if [ ! -f /etc/gitconfig ]; then
    # Se non esiste, crealo
    touch /etc/gitconfig
fi

# Funzione per aggiungere un alias se non esiste
add_alias() {
    local alias_key="$1"
    local alias_value="$2"

    # Controlla se l'alias esiste già nel file di configurazione
    if ! grep -q "\[alias\]" "/etc/gitconfig"; then
        echo "[alias]" >>"/etc/gitconfig"
    fi

    if ! grep -q "^\s*$alias_key\s*=\s*$alias_value" "/etc/gitconfig"; then
        echo "$alias_key=$alias_value" >>"/etc/gitconfig"
        echo "Alias $alias_key aggiunto a /etc/gitconfig."
    else
        echo "Alias $alias_key già presente in /etc/gitconfig."
    fi
}

# Aggiungi gli alias al file /etc/gitconfig
add_alias "pfcs" "proflow candidate start"
add_alias "pfcc" "proflow candidate close"
add_alias "pfrs" "proflow release start"
add_alias "pfrc" "proflow release close"
add_alias "pfhs" "proflow hotfix start"
add_alias "pfhc" "proflow hotfix close"
